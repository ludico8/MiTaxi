/* My Taxi
 * Created by Eduardo oviedo
 * MySQL connection module
 */

var mysql = require('mysql');
var pool;
var credentials = {};

if (process.env.VCAP_SERVICES) {
  console.log('Using envioroment variable.');
  var configuration = JSON.parse(process.env.VCAP_SERVICES);
  credentials = configuration['mysql-5.1'][0]['credentials'];
}else{
  console.log('No envioroment variable found, using local setings intead.');
  credentials.name = 'de01ac1204ae248e5bd7f1018b035ab66'
  credentials.host = '127.0.0.1';
  credentials.port = '10000';
  credentials.user = 'u576y5hW1zGcD';
  credentials.password = 'p1BcrDTbRa25U';
};

pool = mysql.createPool({
  database        : credentials.name,
  host            : credentials.host,
  port            : credentials.port,
  user            : credentials.user,
  password        : credentials.password,
  connectionLimit : 1
});

exports.pool = pool;